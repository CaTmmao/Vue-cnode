(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7aae5324"],{"0a0d":function(t,i,e){t.exports=e("e829")},"2f37":function(t,i,e){var a=e("63b6");a(a.S,"Date",{now:function(){return(new Date).getTime()}})},"3c0c":function(t,i,e){"use strict";var a=e("a2d6"),n=e.n(a);n.a},"86f1":function(t,i,e){t.exports=e.p+"img/thumbs-up.b296ff53.svg"},"9dff":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("section",{staticClass:"topic index-section"},[a("div",[a("div",{staticClass:"topics-container"},[t.loading?a("Loading"):t._e(),t.loading?t._e():a("div",{staticClass:"detail"},[a("div",{staticClass:"topic-top"},[a("div",{staticClass:"topic-title"},[a("h1",[t._v(t._s(t.detail.title))])]),a("div",{staticClass:"topic-bottom"},[a("div",{staticClass:"topic-info"},[a("span",[t._v(" 发布于 "+t._s(t._f("fromNow")(t.detail.create_at))+" • 作者 ")]),a("router-link",{attrs:{to:"/user/"+t.detail.author.loginname}},[t._v(t._s(t.detail.author.loginname)+"\n                            ")]),a("span",[t._v(" • "+t._s(t.detail.visit_count)+" 次浏览 • 最后一次回复是 "+t._s(t._f("fromNow")(t.detail.last_reply_at))+" • 来自 "+t._s(t._f("comeFrom")(t.detail.tab)))])],1),t.isLogin?a("div",{staticClass:"collection"},[a("button",{on:{click:t.collectionBtn}},[t._v(t._s(t.detail.is_collect?"取消收藏":"收藏"))])]):t._e()])]),a("div",{staticClass:"content markdown-body",domProps:{innerHTML:t._s(t.detail.content)}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.detail.reply_count>0&&!t.loading,expression:"detail.reply_count > 0 && !loading"}],staticClass:"reply"},[a("div",{staticClass:"reply-count"},[t._v(t._s(t.detail.reply_count)+" 个回复")]),a("ul",t._l(t.detail.replies,function(i,n){return a("li",{key:i.id,staticClass:"reply-item"},[a("div",{staticClass:"avatar"},[a("router-link",{attrs:{to:"/user/"+i.author.loginname}},[a("img",{attrs:{src:i.author.avatar_url,alt:"头像"}})])],1),a("div",{staticClass:"reply-right"},[a("div",{staticClass:"reply-author"},[a("span",[t._v(t._s(n+1)+"楼")]),a("router-link",{attrs:{to:"/user/"+i.author.loginname}},[t._v(t._s(i.author.loginname))]),a("span",[t._v(t._s(t._f("fromNow")(i.create_at)))]),t.detail.author.loginname===t.detail.replies[n].author.loginname?a("strong",[t._v("作者")]):t._e()],1),a("div",{staticClass:"reply-content markdown-body",domProps:{innerHTML:t._s(i.content)}})]),a("div",{staticClass:"operation"},[a("div",{staticClass:"thumb"},[a("img",{attrs:{src:e("86f1"),alt:"点赞",title:"点赞人数"},on:{click:function(i){return t.likeBtn(t.detail.id,t.detail.author,n)}}}),a("em",[t._v(t._s(i.ups.length))])]),a("div",{on:{click:function(e){return t.replyOthers(i.author.loginname)}}},[a("Icon",{attrs:{title:"回复此楼层",type:"reply"}})],1)])])}),0)]),a("div",{staticClass:"insert-reply"},[a("div",{staticClass:"tip"},[t._v("添加回复")]),a("div",{staticClass:"reply-btn"},[a("textarea",{attrs:{id:"markdown-editor"}}),a("button",{attrs:{type:"button"},on:{click:t.insertReply}},[t._v(t._s(t.sentReply))])])])],1),t.loading?t._e():a("SideBar",{attrs:{loginname:t.detail.author.loginname,from:"topic"}})],1)])},n=[],o=e("cebc"),s=e("0a0d"),l=e.n(s),c=e("ebfb"),r=e.n(c),d=e("365c"),u=e("2f62"),p={name:"topic",data:function(){return{loading:!0,sentReply:"回复",detail:{author:{avatar_url:"",loginname:""},author_id:"",content:"",create_at:l()(),id:"",is_collect:!1,last_reply_at:l()(),replies:[],reply_count:0,tab:"",title:"",top:!1,visit_count:0},simplemde:null}},computed:Object(o["a"])({},Object(u["b"])(["isLogin","userInfo"])),beforeRouteEnter:function(t,i,e){e(function(t){t.fetchTopic()})},methods:{initMarkdownEditor:function(){this.simplemde=new r.a({element:document.getElementById("markdown-editor"),spellChecker:!1})},fetchTopic:function(){var t=this;this.loading=!0,this.$axios.get("".concat(d["a"].topicDetail).concat(this.$route.params.id)).then(function(i){t.loading=!1,t.detail=i.data.data})},collectionBtn:function(){var t=this,i=this.detail.is_collect?"".concat(d["a"].cancelCollection):"".concat(d["a"].collection);this.$axios.post(i,{topic_id:this.detail.id}).then(function(i){t.detail.is_collect=!t.detail.is_collect})},insertReply:function(){this.isLogin?this.$toast("回复API已被cnode社区下线，暂时无法回复!"):this.$toast("请先登录")},likeBtn:function(){this.isLogin?this.$toast("点赞API已被cnode社区下线，暂时无法点赞"):this.$toast("请先登录")},replyOthers:function(t){var i=document.querySelector(".insert-reply").offsetTop;window.scrollTo(0,i),this.simplemde.value("@".concat(t))}},filters:{tagName:function(t){return t.top?"置顶":t.good?"精华":void 0},comeFrom:function(t){switch(t){case"ask":return"问答";case"job":return"招聘";case"dev":return"测试";case"share":return"分享"}}},mounted:function(){var t=this;this.$nextTick(function(){console.log(document.getElementById("markdown-editor")),t.initMarkdownEditor()})}},_=p,m=(e("3c0c"),e("2877")),f=Object(m["a"])(_,a,n,!1,null,"dd065ac8",null);i["default"]=f.exports},a2d6:function(t,i,e){},e829:function(t,i,e){e("2f37"),t.exports=e("584a").Date.now}}]);
//# sourceMappingURL=chunk-7aae5324.140c5d8a.js.map